<!DOCTYPE html>
<html
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:th="http://www.thymeleaf.org"
        xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
        xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
        layout:decorator="layout/layout">
<head>
    <meta charset="UTF-8"/>
    <title>文章浏览</title>

    <script th:src="@{/js/showdown/showdown.min.js}"></script>

    <link rel="stylesheet" th:href="@{/css/article-detail.css}">
    <link rel="stylesheet" th:href="@{/js/highlight/styles/default.css}">

    <script th:src="@{/js/highlight/highlight.pack.js}"></script>
    <script th:src="@{/js/markdown.js}"></script>
    <script th:src="@{/js/article-detail.js}"></script>

    <script th:inline="javascript">
        var article = [[${article}]];

        var praise = new Praise(article.id, 'praiseImg', 'praiseCount');

        $(function(){
            var html = article.content;

            var result = mdToHtml(html);

            $("#content").html(result.html);
            $("#catalog").html(
                "<h5 class='article-catalog-title'>本文目录</h5>" + result.catalog);

             //固定后需要手动指定宽度
             $("#catalog").width($("#catalog").parent().width());

            //初始化点赞对象
             praise.init();
        });

        //点赞
        function doPraise() {
            praise.praise();
        }
    </script>
</head>
<body>
<div layout:fragment="content" class="container-fluid">
    <div class="row">
        <!--文章目录-->
        <div class="hidden-xs-down col-sm-2 p-2 article-catalog fixed-top " style="z-index: 1000; margin-top: 60px; ">
            <div id="catalog" class="article-catalog-content ml-2">

            </div>
        </div>

        <!--文章内容-->
        <div class="col-sm-10 offset-sm-2" style="background: #fff; ">
            <!--文章标题 -->
            <div class="row">
                <div class="col text-center">
                    <h2 id="title" th:text="${article.title}"></h2>
                    <p class="article-subtitle text-muted mr-4">
                        <span class="mr-2"
                                th:text="${article.authorName}
                            + '&nbsp; 发表于&nbsp;' + ${article.createDate}"></span>
                        <span  class="mr-2"
                                th:text="'|&nbsp; &nbsp;' + ${article.readCount} + '&nbsp; 次阅读'"></span>
                        <span id="praiseCount" th:text="${article.praiseCount}"></span>&nbsp; 次点赞
                    </p>
                </div>
            </div>

            <!-- 文章内容  -->
            <div class="row">
                <div class="col" id="content">

                </div>
            </div>

            <!--点赞等按钮-->
            <div class="row article-detail-footer m-2">
                <div class="col text-center ml-2">
                    <button type="button" class="btn btn-link"
                            id="praiseButton"
                            onclick="javascript: doPraise(); ">
                        <img th:src="@{/icons/thumb-up-2x.png}" id="praiseImg"/>
                    </button>
                </div>
            </div>
        </div>
    </div>


</div>
</body>
</html>